# Patent Drafter Application - Environment Variables Example
# Copy this file to .env.local and update with your actual values.

# =============================================================================
# CORE INFRASTRUCTURE - REQUIRED
# =============================================================================

# APPLICATION ENVIRONMENT
# Options: 'development', 'qa', 'production'
NODE_ENV=development

# AUTHENTICATION (Auth0)
# This is used for local/staging development to simulate login.
# It will be replaced by IPD Identity in production.
AUTH0_SECRET= # Generate with: openssl rand -hex 32
AUTH0_BASE_URL=http://localhost:3000
AUTH0_ISSUER_BASE_URL=https://<your-tenant>.auth0.com
AUTH0_CLIENT_ID=
AUTH0_CLIENT_SECRET=
AUTH0_AUDIENCE= # Optional: Your Auth0 API Identifier
AUTH0_SCOPE="openid profile email" # Optional: OAuth scopes

# DATABASE (Prisma)
# Full connection string for your database (e.g., SQL Server, PostgreSQL)
DATABASE_URL="sqlserver://user:password@host:1433/database?encrypt=true"

# AZURE STORAGE
# Required for file/figure uploads. Use Azurite for local development.
AZURE_STORAGE_CONNECTION_STRING="DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://127.0.0.1:10000/devstoreaccount1;"
AZURE_STORAGE_CONTAINER_NAME=figures

# INTERNAL API SECURITY
# Used to protect internal API routes from unauthorized access.
INTERNAL_API_KEY= # DEPRECATED - Use OAuth instead. Generate with: openssl rand -hex 32 for legacy support.

# MALWARE SCANNING
# For file upload security. Get a free API key from https://www.virustotal.com/gui/join-us
# If not configured, file uploads will be blocked in production for security.
VIRUSTOTAL_API_KEY= # Optional but recommended for production

# CONTENT SECURITY POLICY (CSP) MODE
# Controls the strictness of the Content Security Policy
# Options: 'report-only' (test strict CSP), 'strict' (enforce strict CSP), or leave unset for default
# See docs/security/csp-migration-guide.md for details
CSP_MODE= # Optional: 'report-only' or 'strict'

# OAuth Configuration for Internal Services (Recommended)
# Create Machine-to-Machine applications in Auth0 for each service
# Example for citation processor service:
# CITATION_PROCESSOR_CLIENT_ID=
# CITATION_PROCESSOR_CLIENT_SECRET=
# CITATION_PROCESSOR_TENANT_ID= # Optional, for tenant-specific services

# TENANT CONFIGURATION
# Multi-tenant support is enabled - no default tenant in production
# Users must explicitly select their organization or access via /{tenant-slug}/...

# =============================================================================
# AI PROVIDER CONFIGURATION
# =============================================================================

# Choose your AI provider: 'openai' or 'azure'
AI_PROVIDER=openai

# --- Option 1: OpenAI (Default) ---
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4.1
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=8000

# --- Option 2: Azure OpenAI ---
# To use Azure, set AI_PROVIDER='azure' and uncomment/fill these:
# AZURE_OPENAI_API_KEY=
# AZURE_OPENAI_ENDPOINT=https://<your-resource>.openai.azure.com/
# AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4-turbo
# AZURE_OPENAI_API_VERSION=2024-02-01

# --- Optional AI Services ---
PERPLEXITY_API_KEY= # For Perplexity AI research features
AIAPI_API_KEY= # For semantic search functionality

# --- Deep Analysis Configuration ---
DEEP_ANALYSIS_MODEL= # Model to use for deep analysis (defaults to OPENAI_MODEL if not set)
DEEP_ANALYSIS_TIMEOUT_MS=180000 # Timeout for deep analysis in milliseconds (3 minutes default)
DEEP_ANALYSIS_MAX_CITATIONS_PER_ELEMENT=3 # Maximum citations per claim element to prevent token limit issues

# =============================================================================
# CITATION EXTRACTION CONFIGURATION
# =============================================================================

# --- Citation Confidence Thresholds ---
# These control what citations are requested and displayed
CITATION_DEFAULT_THRESHOLD=30 # Default threshold for API requests (percentage)
CITATION_MIN_THRESHOLD=10 # Minimum allowed threshold (prevents setting too low)
CITATION_MAX_THRESHOLD=100 # Maximum allowed threshold (100% confidence)
CITATION_FILTER_THRESHOLD=20 # Post-processing filter (citations below this % are removed)

# =============================================================================
# FEATURE FLAGS & APPLICATION SETTINGS
# =============================================================================

# --- Core Features ---
ENABLE_MULTI_TENANT=true
ENABLE_DRAFTING=true
ENABLE_PRIOR_ART_SEARCH=true
ENABLE_EXAMINER_ANALYSIS=false # Enables USPTO examiner-style analysis features
ENABLE_DEEP_ANALYSIS=false # Enables deep analysis of citation relevance for each claim element
ENABLE_ENHANCED_CITATION_TABLE=false # Enables the enhanced citation table that displays top results from deep analysis
USE_CITATION_WORKER=false # Set to true for external workers, false for inline async processing (default)

# --- Development & Debugging ---
LOG_LEVEL=debug # 'error', 'warn', 'info', 'debug'
DEBUG=false # Enables extra debug logging
DEMO_MODE=false # Enables demo mode with mock data

# --- Build Information (Optional - Set by CI/CD) ---
NEXT_PUBLIC_APP_VERSION=0.1.0
NEXT_PUBLIC_BUILD_DATE=
NEXT_PUBLIC_COMMIT_HASH=

# API Configuration
NEXT_PUBLIC_API_BASE_URL=/api  # Base URL for all API calls (e.g., /api or https://api.example.com)

# Database Configuration (Azure SQL Server - for production)
DB_HOST=your-azure-db-host.database.windows.net  # Database server hostname
DB_NAME=patent_drafter  # Database name
DB_USER=your-db-username  # Database username
DB_PASSWORD=your-db-password  # Database password
DB_PORT=1433  # Database port (1433 for SQL Server)
DB_USE_SSL=true  # Enable SSL for database connections (required for Azure)

# Database Connection Pool Settings (for production optimization)
DATABASE_CONNECTION_LIMIT=10  # Maximum number of connections in the pool
DATABASE_CONNECTION_TIMEOUT=20  # Seconds to wait for a connection
DATABASE_POOL_TIMEOUT=10  # Seconds before timing out when acquiring from pool
DATABASE_IDLE_TIMEOUT=10  # Seconds before closing idle connections
DATABASE_SCHEMA=public  # Database schema to use

# Redis Configuration (for distributed rate limiting & caching)
# For Azure Cache for Redis: redis://:<password>@<name>.redis.cache.windows.net:6380?tls=true
# For local development: redis://localhost:6379
REDIS_URL=  # Redis connection URL (optional - uses in-memory fallback if not set)

# PROXY & CDN CONFIGURATION
# If your application is behind a proxy or CDN, configure trusted proxy settings
# to ensure accurate rate limiting and security checks.
# Common providers are auto-detected: Cloudflare, Azure, Vercel
# For custom proxies, ensure they set a secure header that clients cannot spoof
TRUSTED_PROXY_IPS=  # Comma-separated list of trusted proxy IPs (optional)

# Application Settings
NEXT_PUBLIC_USE_REAL_API=true  # Use real API calls (false for mock data)
NEXT_PUBLIC_DEBOUNCE_TIME=300  # Debounce time for input fields in milliseconds
NEXT_PUBLIC_AUTO_SAVE_INTERVAL=5000  # Auto-save interval in milliseconds

# Authentication Provider Configuration
# Set to 'auth0' for current Auth0 integration or 'ipd' for IPD integration
NEXT_PUBLIC_AUTH_TYPE=auth0

# IPD Integration Settings (for future use)
IPD_BASE_URL=https://ipdashboard.com  # IPD main application URL
IPD_API_URL=https://api.ipdashboard.com  # IPD API endpoint
IPD_COOKIE_DOMAIN=.ipdashboard.com  # Domain for IPD cookies
IPD_SESSION_COOKIE_NAME=ipd_session  # Name of IPD session cookie
IPD_USER_COOKIE_NAME=ipd_user  # Name of IPD user cookie
IPD_TENANT_COOKIE_NAME=ipd_tenant  # Name of IPD tenant cookie

# Azurite Local Development Storage (must be set for local development)
# Default connection string for Azurite emulator
AZURITE_CONNECTION_STRING=DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://127.0.0.1:10000/devstoreaccount1;QueueEndpoint=http://127.0.0.1:10001/devstoreaccount1;TableEndpoint=http://127.0.0.1:10002/devstoreaccount1;

# Note: Never commit your actual .env file with real values to version control
# Copy this file to .env.local and update with your actual values 